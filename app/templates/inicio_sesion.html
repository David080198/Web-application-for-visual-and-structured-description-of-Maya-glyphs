<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="../static/imgs/icono.ico">
    
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='../static/css/iniciar_sesion_movil.css') }}" />
    <link rel="stylesheet" href="../static/css/iniciar_sesion_movil.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <title>Iniciar sesión</title>
    
    <script>

        // Función para obtener y asignar el tamaño de pantalla
        function obtenerTamanioPantalla() {
            // Obtener el tamaño de pantalla
            var anchoPantalla = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
            var altoPantalla = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;

            // Asignar el tamaño de pantalla al campo oculto
            document.getElementById('tamanioPantalla').value = anchoPantalla + 'x' + altoPantalla;
        }

        function llevo_inicio()
        {
            enlace_actual = window.location.href
            enlace_actual_1 = window.location.hostname
            enlace_actual_2 = window.location.pathname
            enlace_actual_3 = window.location.protocol

            console.log(enlace_actual.toString())
            console.log(enlace_actual_1.toString())
            console.log(enlace_actual_2.toString())
            console.log(enlace_actual_3.toString())

            var url = new URL(enlace_actual);
            var result = url.port;

            enlace_nuevo = enlace_actual_3 + "//" + enlace_actual_1 + ":" + result 

            console.log(enlace_nuevo)

            window.location.href = enlace_nuevo
        }

        document.addEventListener('DOMContentLoaded', function () {
            // Coloca aquí el código JavaScript que agrega eventos a los elementos
           
            const caja3 = document.getElementById('email');
            const caja1 = document.getElementById('contrasena');
            
            caja3.addEventListener('input', verificar_correo);
            
            
            function verificar_correo()
            {
                const regexCorreoElectronico = /^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/;
                let correo = document.getElementById('email').value;
    
                if(regexCorreoElectronico.test(correo))
                {
                    console.log("Su correo es valido")
                    
                    document.getElementById("mensaje_correcto_incorrecto").style.color = 'green'
                    document.getElementById("email").style.borderColor = 'green'
                    document.getElementById("mensaje_correcto_incorrecto").style.padding = 0
                }
                else
                {
                    console.log("Correo no valido")
                    
                    document.getElementById("mensaje_correcto_incorrecto").style.color = 'red'
                    document.getElementById("email").style.borderColor = 'red'
                    document.getElementById("mensaje_correcto_incorrecto").style.padding = 0
                }
            }
        });

        function enviar_alerta_datos()
        {
        
        let correo = document.getElementById('email').value;
        let password = document.getElementById('contrasena').value;
        
        // Expresión regular para contraseña 
        const regexCorreoElectronico = /^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/;

        if(regexCorreoElectronico.test(correo))
        {
            console.log("Su correo es valido")
            document.getElementById("mensaje_correcto_incorrecto").style.color = 'green'
            document.getElementById("email").style.borderColor = 'green'
            document.getElementById("mensaje_correcto_incorrecto").style.padding = 0
        }
        else
        {
            console.log("Correo no valido")
            document.getElementById("mensaje_correcto_incorrecto").textContent = "Correo no valido"
            document.getElementById("mensaje_correcto_incorrecto").style.color = 'red'
            document.getElementById("email").style.borderColor = 'red'
            document.getElementById("mensaje_correcto_incorrecto").style.padding = 0

        }

        if(password === "")
        {
            document.getElementById("falta_contraseña").textContent = "Falta tu contraseña"
            document.getElementById("falta_contraseña").style.color = 'red'
            document.getElementById("contrasena").style.borderColor = 'red'
            document.getElementById("falta_contraseña").style.padding = 0
        }

        if(regexCorreoElectronico.test(correo) && password != "")
        {   
            console.log("Si entro a la secuencia de condicionales completas");
            //document.getElementById("container_modal").style.display = "block";
            //document.getElementById("modal_1").style.display = "block";

            return true;
                   
        }
        
    }
    function llevar_a_recuperar_contraseña()
    {
        enlace_actual = window.location.href
        enlace_actual_1 = window.location.hostname
        enlace_actual_2 = window.location.pathname
        enlace_actual_3 = window.location.protocol

        console.log(enlace_actual.toString())
        console.log(enlace_actual_1.toString())
        console.log(enlace_actual_2.toString())
        console.log(enlace_actual_3.toString())

        var url = new URL(enlace_actual);
        var result = url.port;

        enlace_nuevo = enlace_actual_3 + "//" + enlace_actual_1 + ":" + result + "/recuperar_contraseña"
        console.log(enlace_nuevo)

        //window.location.replace(enlace_nuevo);
    }

    function inicio_idioma(idioma)
    {
        if(idioma == "español")
        {
            document.getElementById("email_label").innerHTML = "Correo Electrónico:"
            document.getElementById("cajas_texto_email").placeholder = "Correo Electrónico"
            document.getElementById("contrasena_label").innerHTML = "Contraseña"
            document.getElementById("cajas_texto_contrasena").placeholder = "Contraseña"
            document.getElementById("enlace_contrasena").innerHTML = "He olvidado mi contraseña"
            document.getElementById("boton_español").innerHTML = "Español"
            document.getElementById("boton_ingles").innerHTML = "Ingles"
            document.getElementById("submit_boton").value = "Iniciar sesión"
            document.getElementById("anuncio_h2").innerHTML = "Iniciar Sesión"
            document.getElementById("boton_español").style.border = "thin solid white"
            document.getElementById("boton_ingles").style.border = "none"
        }
        if (idioma == "ingles")
        {
            document.getElementById("email_label").innerHTML = "Email address:"
            document.getElementById("cajas_texto_email").placeholder = "Email address"
            document.getElementById("contrasena_label").innerHTML = "Password"
            document.getElementById("cajas_texto_contrasena").placeholder = "Password"
            document.getElementById("enlace_contrasena").innerHTML = "I forgot my password"
            document.getElementById("boton_español").innerHTML = "Spanish"
            document.getElementById("boton_ingles").innerHTML = "English"
            document.getElementById("submit_boton").value = "Log in"
            document.getElementById("anuncio_h2").innerHTML = "Log in"
            document.getElementById("boton_español").style.border = "none"
            document.getElementById("boton_ingles").style.border = "thin solid white"
        }
    }

    </script>
</head>
<body>
    <button class="boton-cabecera" onclick=llevo_inicio()>
        <span class="material-symbols-outlined">
            arrow_back
        </span>
    </button>
    <div>
        <p class="encabezado">Instituto Politénico Nacional</p>
        <p class="encabezado">Centro de Investigación en Computación</p>
    </div>
    <div class="container">
        <h2 id="anuncio_h2">Iniciar Sesión</h2>
        <form method="POST" class="class_form_register" id="form_register" action="/iniciar_sesion/" onsubmit="return enviar_alerta_datos()"> 
            <label id="email_label" class="email_label" for="email">Correo Electrónico:</label>
            <input id="cajas_texto_email" class="cajas_texto email" type="email" id="email" name="email" required placeholder="Correo electronico" >
            
            <br>
            <label id="contrasena_label" class="contrasena_label" for="contrasena">Contraseña:</label>
            <input id="cajas_texto_contrasena" class="cajas_texto contrasena" type="password" id="contrasena" name="contrasena" placeholder="Contraseña" required>
        
            <br>
            <a id="enlace_contrasena" class = "enlace_contrasena" href="{{url_for('contrasena_olvidada')}}">He olvidado mi contraseña</a>

            <input type="hidden" id="tamanioPantalla" name="tamanioPantalla">

            <input id="submit_boton" class="submit_boton"  type="submit" value="Iniciar sesión" onclick="obtenerTamanioPantalla()">
            
            <!--<input class="submit_boton"  type="submit" value="Registrarse" onclick="enviar_alerta_datos()"> -->
        </form>
    </div>
    <p style="color:red;font-weight:bold;text-align:center;">{{mensaje}}</p>
    <div class="botones_idiomas">
        <button id= "boton_español" class="boton_español" onclick="inicio_idioma('español')" style="border: thin solid rgb(239,239,239);">Español</button>
        <button id= "boton_ingles" class="boton_ingles" onclick="inicio_idioma('ingles')" style="border: none">Ingles</button>
    </div>
</body>
</html>

